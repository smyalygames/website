---
sidebar_position: 5
title: Updating from v3 to v4
toc_max_heading_level: 5
---

## Before you start

It is important to note that the primary breaking change of Sapphire v4 is support for DiscordJS v14.x. This means that
for most of the breaking changes you should refer to [DiscordJS' upgrade guide][djs-migration].

## Sapphire specific changes

Sapphire has a few changes that are not related to DiscordJS. These are not necessarily breaking changes but should be
noted nonetheless.

- The [`Identifiers`][Identifiers] enum was changed from `const enum` to [`enum`][enum].
- The [`CommandOptionsRunTypeEnum`][CommandOptionsRunTypeEnum] enum was changed from `const enum` to [`enum`][enum].
- The [`CommandPreConditions`][CommandPreConditions] enum was changed from `const enum` to [`enum`][enum].
- The [`InteractionHandlerTypes`][InteractionHandlerTypes] enum was changed from `const enum` to [`enum`][enum].
- The [`LogLevel`][LogLevel] enum was changed from `const enum` to [`enum`][enum].
- The [`PreconditionRunMode`][PreconditionRunMode] enum was changed from `const enum` to [`enum`][enum].
- The type alias [`Command.ChatInputInteraction`][ChatInputInteraction] was changed to
  [`Command.ChatInputCommandInteraction`][ChatInputCommandInteraction].
- The type alias [`Command.ContextMenuInteraction`][ContextMenuInteraction] was changed to
  [`Command.ContextMenuCommandInteraction`][ContextMenuCommandInteraction].
- The `default_permission` option for Application Commands has been removed to match the removal on the discord.js and
  Discord API side.

## DiscordJS specific changes

The new update on how intents are enabled requires you to have `GatewayIntentBits.MessageContent` as an intent if the
bot uses message commands or requires `content`, `attachments`, `embeds` and `components`, even if you already have 
`GatewayIntentBits.GuildMessages` in your intents.

[ChatInputCommandInteraction]: https://github.com/sapphiredev/framework/blob/main/src/lib/structures/Command.ts#L822
[ChatInputInteraction]: https://github.com/sapphiredev/framework/blob/v3.2.0/src/lib/structures/Command.ts#L820
[CommandOptionsRunTypeEnum]: https://github.com/sapphiredev/framework/blob/main/src/lib/structures/Command.ts#L547
[CommandPreConditions]: https://github.com/sapphiredev/framework/blob/main/src/lib/structures/Command.ts#L562
[ContextMenuCommandInteraction]: https://github.com/sapphiredev/framework/blob/main/src/lib/structures/Command.ts#L824
[ContextMenuInteraction]: https://github.com/sapphiredev/framework/blob/v3.2.0/src/lib/structures/Command.ts#L822
[djs-migration]: https://discordjs.guide/additional-info/changes-in-v14.html
[enum]: https://www.typescriptlang.org/docs/handbook/enums.html
[Identifiers]: https://github.com/sapphiredev/framework/blob/main/src/lib/errors/Identifiers.ts#L1
[InteractionHandlerTypes]:
  https://github.com/sapphiredev/framework/blob/main/src/lib/structures/InteractionHandler.ts#L106
[InternalRegistryAPIType]: https://github.com/sapphiredev/framework/blob/main/src/lib/types/Enums.ts#L61
[LogLevel]: https://github.com/sapphiredev/framework/blob/main/src/lib/utils/logger/ILogger.ts#L4
[PreconditionRunMode]:
  https://github.com/sapphiredev/framework/blob/main/src/lib/utils/preconditions/PreconditionContainerArray.ts#L19
